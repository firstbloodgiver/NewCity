@model IEnumerable<NewCity.Models.StoryCard>
@using NewCity.Enum;
@{
    ViewData["Title"] = "Creator";
    EnumConditionType enumConditionType = new EnumConditionType();
}

<!--故事卡包装为树。新建下一故事卡要在故事卡里面建-->
<div class="container-fluid">
    <div class="row">
        <div class="col-md-4">tree</div>
        <div class="col-md-8">
            <div class="row">
                <div id="StoryId">
                    @Model.First().ID
                </div>
                <div id="StoryName">
                    @Model.First().StoryName
                </div>
            </div>
            <div class="row">
                <div class="col-md-4" id="Img">
                    <!--img-->
                    @Model.First().IMG
                </div>
                <div class="col-md-8" id="Content">
                    @Model.First().Text
                    <!--text-->
                </div>
            </div>
            <div class="row" id="Option">
                @foreach (var item in Model.First().StoryOptions)
                {
                    <div class="row" id="@item.ID">
                        <button type="button" onclick="Condition('@item.ID')">条件</button>
                        <button type="button">@item.Text</button>
                        <button type="button" onclick="Effect('@item.ID')">效果</button>
                        <button type="button" onclick="Cancel()">取消</button>
                        <button type="button" onclick="NextCard('@item.ID')">→</button>
                    </div>
                }
                <button type="button" onclick="AddOption()">增加</button>foreach
            </div>
            <div class="row">
                <button type="button" class="btn" onclick="Save()">保存</button>
            </div>
        </div>
    </div>
</div>



<!--条件模态框-->
<div id="Condition" class="modal fade">
    <form id="Condition-form">

        <button type="submit"></button>
    </form>
    <button onclick="AddCondition()">+</button>
</div>

<script>
    $(document).ready(function () {
        //返回第一个故事卡到主页面
        //加载树
    })


    function GetStoryCard() {
        //点击树加载该故事卡到主页面

    }

    function Save() {

    }

    function AddOption() {

    }

    //设置条件
    function Condition(optionid) {
        //加载模态款数据
        //出现模态框
        //选择条件类型 人物参数/故事状态 参数 < > = trul false 123456789 10 json[{name=speed,条件=大于,value=6}]
        //保存 添加到list
        //保存数据库
        $.post("/CreateStoryController/GetCondition", { optionid: optionid }, function (data) {
            let json = JSON.parse(data);
            if (json) {
                for (let i in json) {
                    let Name = "<input id='input-name-" + i + "'/>";
                    let Type = "<select id='select-type-" + i + "'>" +
                        + "<option value='1'>></option>"
                        + "<option value='2'><</option>"
                        + "<option value='3'>=</option>"
                        + "<option value='4'>≠</option>"
                        + "</select>";
                    let Value = "<input id='input-value-" + i + "'/>";
                    let Delete = "<div onclick='ConditionCancel()'>取消</div>"
                    toappend = Name + Type + Value + Delete;
                    let toappend = "<div class='row'>" + context + "</div>"
                    $("#Condition-form").append(toappend)

                    //赋值
                    $("#input-name-" + i + "").val(json[i].Name);
                    $("#select-type-" + i + "").text(enumConditionType[json[i].Type]);
                    $("#select-type-" + i + "").val(json[i].Type);
                    $("#input-value-" + i + "").val(json[i].Value);
                }

            }
        })
        $('#Condition').modal('show');

    }

    //设置效果
    function Effect(optionid) {

    }

    //取消选项
    function Cancel(optionid) {

    }

    //取消条件
    function ConditionCancel() {

    }

    //增加条件
    function AddCondition() {

    }

    //下一张卡
    function NextCard(optionid) {

    }

    //
    var enumConditionType = [ ">", "<", "=", "≠" ];


</script>

